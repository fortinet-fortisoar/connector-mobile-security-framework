{
  "name": "mobile-security-framework",
  "label": "Mobile Security Framework",
  "version": "1.0.0",
  "description": "Mobile Security Framework (MobSF) is an automated, all-in-one mobile application (Android/iOS/Windows) pen-testing, malware analysis and security assessment framework capable of performing static and dynamic analysis. MobSF support mobile app binaries (APK, XAPK, IPA & APPX) along with zipped source code and provides REST APIs for seamless integration with your CI/CD or DevSecOps pipeline. The Dynamic Analyzer helps you to perform runtime security assessment and interactive instrumented testing.",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "category": "Threat Hunting and Search",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "help_online": "",
  "configuration": {
    "fields": [
      {
        "name": "server_url",
        "title": "Server URL",
        "type": "text",
        "editable": true,
        "visible": true,
        "required": true,
        "tooltip": "Specify the URL/IP address of your MobSF Instance.",
        "description": "Specify the URL/IP address of your MobSF Instance."
      },
      {
        "name": "api_key",
        "title": "API Key",
        "type": "text",
        "editable": true,
        "visible": true,
        "required": true,
        "tooltip": "Specify the API Key that you have generated on the MobSF instance.",
        "description": "Specify the API Key that you have generated on the MobSF instance."
      },
      {
        "name": "verify_ssl",
        "title": "Verify SSL",
        "type": "checkbox",
        "editable": true,
        "visible": true,
        "required": false,
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
      }
    ]
  },
  "operations": [
    {
      "operation": "upload_file",
      "title": "Upload File",
      "annotation": "upload_file",
      "description": "This action uploads a file to your MobSF instance. Supported file types are apk, zip, ipa and appx.",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "input",
          "title": "Type",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Select a method of file submission to MobSF for analysis. You can select from following options: (Attachment ID, File IRI)",
          "description": "Select a method of file submission to MobSF for analysis. You can select from following options: (Attachment ID, File IRI)",
          "options": [
            "Attachment ID",
            "File IRI"
          ]
        },
        {
          "name": "value",
          "title": "Reference ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify a reference ID to access the attachment metadata from FortiSOAR\u2122's Attachments module. If you have selected Attachment ID, this defaults to the {{vars.attachment_id}} value. If you have selected File IRI, then this defaults to the {{vars.file_iri}} value.",
          "description": "Specify a reference ID to access the attachment metadata from FortiSOAR\u2122's Attachments module. If you have selected Attachment ID, this defaults to the {{vars.attachment_id}} value. If you have selected File IRI, then this defaults to the {{vars.file_iri}} value."
        }
      ],
      "output_schema": {
        "hash": "",
        "status": "",
        "analyzer": "",
        "file_name": "",
        "scan_type": ""
      }
    },
    {
      "operation": "scan_file",
      "title": "Scan File",
      "annotation": "scan_file",
      "description": "Scan a file which is uploaded on MobSF instance.",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "scan_type",
          "title": "Scan Type",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the type of file you want to scan.",
          "description": "Specify the type of file you want to scan.",
          "options": [
            "xapk",
            "apk",
            "apks",
            "zip",
            "ipa",
            "appx"
          ]
        },
        {
          "name": "file_name",
          "title": "File Name",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the name of the app with extension you want to Scan.",
          "description": "Specify the name of the app with extension you want to Scan."
        },
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the hash code of the File which you get when uploading a file.",
          "description": "Specify the hash code of the File which you get when uploading a file."
        },
        {
          "name": "re_scan",
          "title": "Rescan File",
          "type": "checkbox",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Tick if you want to Rescan the File, Default is False.",
          "description": "Tick if you want to Rescan the File, Default is False.",
          "value": false
        }
      ],
      "output_schema": {}
    },
    {
      "operation": "delete_scan",
      "title": "Delete Scan",
      "annotation": "delete_scan",
      "description": "Delete scan results saved on MobSF instance.",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Hash of the Scan you want to delete.",
          "description": "Hash of the Scan you want to delete."
        }
      ],
      "output_schema": {
        "deleted": ""
      }
    },
    {
      "operation": "display_recent_scans",
      "title": "Display Recent Scans",
      "annotation": "display_recent_scans",
      "description": "Display Recent Scan Results",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "page",
          "title": "Page",
          "type": "integer",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify the Page Number you want to fetch.",
          "description": "Specify the Page Number you want to fetch."
        },
        {
          "name": "page_size",
          "title": "Page Size",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify the Number of Scans to list per page.",
          "description": "Specify the Number of Scans to list per page."
        }
      ],
      "output_schema": {
        "count": "",
        "content": [
          {
            "MD5": "",
            "ANALYZER": "",
            "APP_NAME": "",
            "FILE_NAME": "",
            "SCAN_TYPE": "",
            "TIMESTAMP": "",
            "PACKAGE_NAME": "",
            "VERSION_NAME": ""
          }
        ],
        "num_pages": ""
      }
    },
    {
      "operation": "app_scorecard",
      "title": "App Scorecard",
      "annotation": "app_scorecard",
      "description": "Get MobSF Application Security Scorecard\n\n",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan File.",
          "description": "Specify the Hash of the Scan File."
        }
      ],
      "output_schema": {
        "hash": "",
        "high": [
          {
            "title": "",
            "section": "",
            "description": ""
          }
        ],
        "info": [
          {
            "title": "",
            "section": "",
            "description": ""
          }
        ],
        "efr01": "",
        "title": "",
        "secure": [],
        "hotspot": [
          {
            "title": "",
            "section": "",
            "description": ""
          }
        ],
        "version": "",
        "warning": [
          {
            "title": "",
            "section": "",
            "description": ""
          }
        ],
        "app_name": "",
        "trackers": "",
        "file_name": "",
        "version_name": "",
        "security_score": "",
        "total_trackers": ""
      }
    },
    {
      "operation": "generate_pdf_report",
      "title": "Generate PDF Report",
      "annotation": "generate_pdf_report",
      "description": "Generate PDF Report of Scan Result",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan File.",
          "description": "Specify the Hash of the Scan File."
        },
        {
          "name": "file_name",
          "title": "File Name",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan File.",
          "description": "Specify the Hash of the Scan File."
        }
      ],
      "output_schema": {
        "id": "",
        "@id": "",
        "cVEs": [],
        "file": {
          "id": "",
          "@id": "",
          "size": "",
          "uuid": "",
          "@type": "",
          "assignee": "",
          "filename": "",
          "metadata": [],
          "mimeType": "",
          "thumbnail": "",
          "uploadDate": ""
        },
        "name": "",
        "type": "",
        "uuid": "",
        "@type": "",
        "tasks": [],
        "alerts": [],
        "assets": [],
        "owners": [],
        "people": [],
        "tenant": {
          "id": "",
          "@id": "",
          "name": "",
          "role": "",
          "uuid": "",
          "@type": "",
          "region": "",
          "license": "",
          "industry": "",
          "tenantId": "",
          "createDate": "",
          "createUser": "",
          "modifyDate": "",
          "modifyUser": "",
          "description": "",
          "isDedicated": "",
          "allowRemoteMMDModification": ""
        },
        "@context": "",
        "assignee": "",
        "comments": [],
        "conflict": "",
        "warrooms": [],
        "incidents": [],
        "createDate": "",
        "createUser": {
          "id": "",
          "@id": "",
          "name": "",
          "uuid": "",
          "@type": "",
          "avatar": "",
          "userId": "",
          "userType": "",
          "createDate": "",
          "createUser": "",
          "modifyDate": "",
          "modifyUser": ""
        },
        "indicators": [],
        "modifyDate": "",
        "modifyUser": {
          "id": "",
          "@id": "",
          "name": "",
          "uuid": "",
          "@type": "",
          "avatar": "",
          "userId": "",
          "userType": "",
          "createDate": "",
          "createUser": "",
          "modifyDate": "",
          "modifyUser": ""
        },
        "recordTags": [],
        "userOwners": [],
        "workspaces": [],
        "description": "",
        "tenantRecordId": "",
        "vulnerabilities": []
      }
    },
    {
      "operation": "generate_json_report",
      "title": "Generate JSON Report",
      "annotation": "generate_json_report",
      "description": "Generate JSON Report of the Scan Result",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan File.",
          "description": "Specify the Hash of the Scan File."
        }
      ],
      "output_schema": {}
    },
    {
      "operation": "view_source_files",
      "title": "View Source Files",
      "annotation": "view_source_files",
      "description": "View Resource file of the Scan result",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "file",
          "title": "File Path",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the relative path of the Source File which you want to See. By default, Path directory is in /home/mobsf/.MobSF/{hash_key}/java_source",
          "description": "Specify the relative path of the Source File which you want to See. By default, Path directory is in /home/mobsf/.MobSF/{hash_key}/java_source"
        },
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan File",
          "description": "Specify the Hash of the Scan File"
        },
        {
          "name": "type",
          "title": "File Type",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the App file type.",
          "description": "Specify the App file type.",
          "options": [
            "apk",
            "ipa",
            "studio",
            "eclipse",
            "ios"
          ]
        }
      ],
      "output_schema": {}
    },
    {
      "operation": "compare_apps",
      "title": "Compare Apps",
      "annotation": "compare_apps",
      "description": "Compare Scan Result of two different Scans",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash1",
          "title": "Hash of First Scan",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the First Scan File.",
          "description": "Specify the Hash of the First Scan File."
        },
        {
          "name": "hash2",
          "title": "Hash of Second Scan",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Second Scan File.",
          "description": "Specify the Hash of the Second Scan File."
        }
      ],
      "output_schema": {}
    },
    {
      "operation": "suppress_by_rule",
      "title": "Suppress by Rule",
      "annotation": "suppress_by_rule",
      "description": "Suppress findings by rule id.",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan.",
          "description": "Specify the Hash of the Scan."
        },
        {
          "name": "type",
          "title": "Type",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the type of the Scan.",
          "description": "Specify the type of the Scan.",
          "options": [
            "code",
            "manifest"
          ]
        },
        {
          "name": "rule",
          "title": "Rule",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Rule ID of the Scan.",
          "description": "Specify the Rule ID of the Scan."
        }
      ],
      "output_schema": {
        "status": ""
      }
    },
    {
      "operation": "suppress_by_files",
      "title": "Suppress by Files",
      "annotation": "suppress_by_files",
      "description": "Suppress findings by files.\n\n",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan.",
          "description": "Specify the Hash of the Scan."
        },
        {
          "name": "type",
          "title": "Type",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the type of the Scan.",
          "description": "Specify the type of the Scan.",
          "options": [
            "code"
          ]
        },
        {
          "name": "rule",
          "title": "Rule",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Rule ID of the Scan.",
          "description": "Specify the Rule ID of the Scan."
        }
      ],
      "output_schema": {

      }
    },
    {
      "operation": "view_suppressions",
      "title": "View Suppressions",
      "annotation": "view_suppressions",
      "description": "List suppressions associated with a given Scan result.",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan.",
          "description": "Specify the Hash of the Scan."
        }
      ],
      "output_schema": {
        "status": "",
        "message": []
      }
    },
    {
      "operation": "delete_suppressions",
      "title": "Delete Suppressions",
      "annotation": "delete_suppressions",
      "description": "Delete suppressions with a given Scan result.",
      "category": "investigation",
      "is_config_required": true,
      "visible": true,
      "enabled": true,
      "parameters": [
        {
          "name": "hash",
          "title": "Hash",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Hash of the Scan.",
          "description": "Specify the Hash of the Scan."
        },
        {
          "name": "type",
          "title": "Type",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the type of the Scan.",
          "description": "Specify the type of the Scan.",
          "options": [
            "code",
            "manifest"
          ]
        },
        {
          "name": "rule",
          "title": "Rule",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the Rule ID of the Scan.",
          "description": "Specify the Rule ID of the Scan."
        },
        {
          "name": "kind",
          "title": "Kind of Scan",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Specify the kind of the Scan.",
          "description": "Specify the kind of the Scan.",
          "options": [
            "rule",
            "file"
          ]
        }
      ],
      "output_schema": {}
    }
  ]
}